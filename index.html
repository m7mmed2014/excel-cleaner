<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù‚ÙˆØ§ÙÙ„ Ù…Ø­Ù…Ø¯ Ø±Ø¬Ø¨ Ø§Ù„Ø®ÙŠØ±ÙŠØ© | Ø£Ø¯Ø§Ø© ØªØ®ÙÙŠÙ Ø§Ù„Ø´ÙŠØªØ§Øª Ø§Ù„ÙØ§Ø®Ø±Ø©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&family=Amiri:wght@700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%); min-height: 100vh; }
        .glass { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .gold-gradient { background: linear-gradient(45deg, #f59e0b, #fbbf24, #fde68a, #fbbf24, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .card-shadow { box-shadow: 0 20px 40px rgba(0,0,0,0.4), 0 0 100px rgba(251, 191, 36, 0.2); }
        .btn-glow { box-shadow: 0 0 30px rgba(251, 191, 36, 0.6); transition: all 0.3s; }
        .btn-glow:hover { transform: translateY(-4px); box-shadow: 0 0 50px rgba(251, 191, 36, 0.9); }
        .sticky-header { position: sticky; top: 0; z-index: 40; background: #1e293b !important; }
        .sticky-col { position: sticky; right: 0; z-index: 30; background: #f59e0b !important; color: #1e293b; font-weight: 900; }
        .tab-active { background: linear-gradient(45deg, #f59e0b, #fbbf24); color: #1e293b; }
        .zoom-btn:hover { transform: scale(1.3) rotate(90deg); }
        #preview-container { scrollbar-color: #f59e0b #1e293b; }
        #preview-container::-webkit-scrollbar { height: 12px; width: 12px; }
        #preview-container::-webkit-scrollbar-track { background: #1e293b; border-radius: 10px; }
        #preview-container::-webkit-scrollbar-thumb { background: linear-gradient(#f59e0b, #fbbf24); border-radius: 10px; }
        
        /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© */
        #preview-container table { 
            direction: rtl; 
            width: 100%; 
            min-width: 1200px; 
            border-collapse: separate; 
            border-spacing: 0; 
            font-size: 1rem; 
        }
        #preview-container th, #preview-container td { 
            padding: 12px 16px; 
            text-align: right; 
            border: 2px solid rgba(251, 191, 36, 0.5); 
            background: rgba(255, 255, 255, 0.05); 
        }
        #preview-container th { 
            background: linear-gradient(45deg, #1e293b, #334155); 
            color: #fbbf24; 
            font-weight: 900; 
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5); 
        }
        #preview-container tr:nth-child(even) td { background: rgba(255, 255, 255, 0.1); }
        #preview-container .gold-cell { color: #fbbf24; font-weight: bold; }
        #preview-container .empty-id { color: #ef4444; font-style: italic; }
    </style>
</head>
<body class="text-white">

<div class="container mx-auto px-4 py-8 max-w-7xl">
    <div class="glass rounded-3xl card-shadow p-8 md:p-12 text-center">
        <div class="mb-8">
            <h1 class="text-5xl md:text-7xl font-extrabold gold-gradient mb-4 tracking-wider">
                Ù‚ÙˆØ§ÙÙ„ Ù…Ø­Ù…Ø¯ Ø±Ø¬Ø¨ Ø§Ù„Ø®ÙŠØ±ÙŠØ©
            </h1>
            <p class="text-2xl md:text-3xl gold-gradient font-bold">Ø£Ø¯Ø§Ø© ØªØ®ÙÙŠÙ Ø§Ù„Ø´ÙŠØªØ§Øª Ø§Ù„ÙØ§Ø®Ø±Ø©</p>
            <p class="text-lg md:text-xl text-amber-200 mt-4">Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª â€¢ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ (Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·) â€¢ Ø§Ù„Ø®Ø§Ù†Ø© ÙØ§Ø¶ÙŠØ© = ÙØ§Ø¶ÙŠØ© â€¢ Ù…Ø¹Ø§ÙŠÙ†Ø© ÙÙˆØ±ÙŠØ© ÙˆØ§Ø¶Ø­Ø© â€¢ Ù†Ø³Ø® Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 my-12">
            <div class="glass rounded-2xl p-6 border border-amber-500/50 card-shadow">
                <p class="text-xl italic gold-gradient font-Amiri">"Ø§Ù„Ø¹Ø·Ø§Ø¡ Ù„Ø§ ÙŠÙ†Ù‚Øµ Ù…Ù† Ø§Ù„Ù…Ø§Ù„ØŒ Ø¨Ù„ ÙŠØ²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¨Ø±ÙƒØ©"</p>
            </div>
            <div class="glass rounded-2xl p-6 border border-amber-500/50 card-shadow">
                <p class="text-xl italic gold-gradient font-Amiri">"Ø®ÙŠØ± Ø§Ù„Ù†Ø§Ø³ Ø£Ù†ÙØ¹Ù‡Ù… Ù„Ù„Ù†Ø§Ø³"</p>
            </div>
            <div class="glass rounded-2xl p-6 border border-amber-500/50 card-shadow">
                <p class="text-xl italic gold-gradient font-Amiri">"Ø¨Ø°Ø±Ø© Ø®ÙŠØ± Ø§Ù„ÙŠÙˆÙ… = Ø­Ø¯ÙŠÙ‚Ø© Ø£Ù…Ù„ ØºØ¯Ø§Ù‹"</p>
            </div>
        </div>

        <div class="my-12">
            <input type="file" id="file-upload" class="block w-full text-lg file:mr-6 file:py-6 file:px-12 file:rounded-full file:border-0 file:text-xl file:font-bold file:bg-gradient-to-r file:from-amber-500 file:to-yellow-600 file:text-amber-900 hover:file:from-amber-600 hover:file:to-yellow-700 file:shadow-2xl file:btn-glow cursor-pointer" accept=".xlsx,.xls">
        </div>

        <div id="loading-spinner" class="hidden my-12">
            <div class="flex flex-col items-center space-y-6">
                <div class="relative">
                    <svg class="animate-spin h-24 w-24 text-amber-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <span class="text-4xl gold-gradient font-bold">âœ¨</span>
                    </div>
                </div>
                <p id="loading-text" class="text-2xl gold-gradient font-bold">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø³Ø­Ø±...</p>
            </div>
        </div>

        <p id="status-message" class="text-xl text-amber-200">Ø¬Ø§Ù‡Ø² Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ù…Ù„Ù  ğŸ‘‘</p>

        <div id="preview-area" class="mt-12 hidden">
            <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                <div id="preview-tabs" class="flex overflow-x-auto space-x-reverse space-x-4 pb-2"></div>
                <div class="flex flex-wrap justify-center gap-4">
                    <button id="zoom-in" class="zoom-btn bg-amber-600 text-amber-900 p-4 rounded-full btn-glow text-2xl font-bold">+</button>
                    <button id="zoom-out" class="zoom-btn bg-amber-600 text-amber-900 p-4 rounded-full btn-glow text-2xl font-bold">âˆ’</button>
                    <button id="copy-image" class="bg-gradient-to-r from-green-600 to-emerald-700 text-white px-8 py-4 rounded-full btn-glow font-bold text-xl flex items-center gap-3">
                        <span>ğŸ“‹ Ù†Ø³Ø® Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨</span>
                    </button>
                    <button id="share-whatsapp" class="bg-gradient-to-r from-green-500 to-emerald-600 text-white px-8 py-4 rounded-full btn-glow font-bold text-xl">ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø© ğŸ“±</button>
                </div>
            </div>
            <div id="preview-container" class="glass rounded-2xl overflow-auto max-h-96 border-2 border-amber-500/50 card-shadow p-4"></div>
        </div>

        <div id="actions-container" class="mt-12 hidden">
            <button id="download-button" class="w-full bg-gradient-to-r from-amber-500 to-yellow-600 text-amber-900 font-bold py-8 px-16 rounded-3xl card-shadow btn-glow hover:from-amber-600 hover:to-yellow-700 transition text-3xl md:text-4xl">
                ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù†Ø¸ÙŠÙ Ø§Ù„ÙØ§Ø®Ø±
            </button>
        </div>
    </div>

    <div class="text-center text-amber-300 text-lg mt-12 glass rounded-2xl p-6 card-shadow">
        <p class="font-bold text-2xl gold-gradient">ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø©: Ù…Ø­Ù…Ø¯ Ù…Ø¨Ø±ÙˆÙƒ</p>
        <p class="text-xl">ğŸ“ 01020114049 | âœ¨ Ù†Ø³Ø®Ø©2025</p>
    </div>
</div>

<script>
    const fileUpload = document.getElementById('file-upload');
    const loadingSpinner = document.getElementById('loading-spinner');
    const loadingText = document.getElementById('loading-text');
    const statusMessage = document.getElementById('status-message');
    const previewArea = document.getElementById('preview-area');
    const previewTabs = document.getElementById('preview-tabs');
    const previewContainer = document.getElementById('preview-container');
    const actionsContainer = document.getElementById('actions-container');
    const downloadButton = document.getElementById('download-button');
    const zoomIn = document.getElementById('zoom-in');
    const zoomOut = document.getElementById('zoom-out');
    const copyImage = document.getElementById('copy-image');
    const shareWhatsapp = document.getElementById('share-whatsapp');

    let processedFileBlob = null;
    let originalFileName = '';
    let workbook = null;
    let currentZoom = 1;

    const newHeader = ["Ù…", "Ø§Ø³Ù… Ø§Ù„Ø²ÙˆØ¬", "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ", "Ø§Ø³Ù… Ø§Ù„Ø²ÙˆØ¬Ù‡", "Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø²ÙˆØ¬Ù‡", "Ø§Ù„Ø­Ø§Ù„Ù‡", "Ø§Ù„Ø¹Ù†ÙˆØ§Ù†", "Ø±Ù‚Ù… 1", "Ø±Ù‚Ù… 2", "", "", "", "", "", "ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¨ÙˆÙ†"];
    const idColumns = [2, 4]; // Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø²ÙˆØ¬ ÙˆØ§Ù„Ø²ÙˆØ¬Ø©

    fileUpload.addEventListener('change', handleFile);
    downloadButton.addEventListener('click', downloadFile);
    zoomIn.addEventListener('click', () => { currentZoom += 0.15; updateZoom(); });
    zoomOut.addEventListener('click', () => { currentZoom = Math.max(0.6, currentZoom - 0.15); updateZoom(); });
    copyImage.addEventListener('click', copyAsImage);
    shareWhatsapp.addEventListener('click', shareOnWhatsapp);

    function setLoading(loading, text = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø³Ø­Ø±...") {
        loadingText.textContent = text;
        loading ? loadingSpinner.classList.remove('hidden') : loadingSpinner.classList.add('hidden');
    }

    function updateZoom() {
        previewContainer.style.transform = `scale(${currentZoom})`;
        previewContainer.style.transformOrigin = 'top right';
    }

    async function handleFile(event) {
        const file = event.target.files[0];
        if (!file) return;

        originalFileName = file.name.replace(/\.[^/.]+$/, "");
        setLoading(true, 'Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ù„ÙƒÙŠ...');
        previewArea.classList.add('hidden');
        actionsContainer.classList.add('hidden');
        previewTabs.innerHTML = '';
        previewContainer.innerHTML = '';
        processedFileBlob = null;

        try {
            const data = await file.arrayBuffer();
            workbook = XLSX.read(data, { type: 'array', cellDates: true });

            setLoading(true, 'ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·...');

            workbook.SheetNames.forEach(sheetName => {
                const ws = workbook.Sheets[sheetName];
                const oldData = XLSX.utils.sheet_to_json(ws, { header: 1, defval: '', blankrows: false });
                const dataWithoutHeader = oldData.slice(1) || [];

                XLSX.utils.sheet_add_aoa(ws, [], { origin: 'A1' });
                XLSX.utils.sheet_add_aoa(ws, [newHeader], { origin: 'A1' });
                XLSX.utils.sheet_add_json(ws, dataWithoutHeader, { origin: 'A2', skipHeader: true });

                const range = XLSX.utils.decode_range(ws['!ref']);
                const colWidths = [];

                for (let R = range.s.r; R <= range.e.r; ++R) {
                    for (let C = range.s.c; C <= range.e.c; ++C) {
                        const cell = ws[XLSX.utils.encode_cell({ c: C, r: R })];
                        if (!cell) continue;

                        if (cell.f) delete cell.f;

                        // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ: Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø· + Ù„Ùˆ ÙØ§Ø¶ÙŠ ÙŠØ³ÙŠØ¨ ÙØ§Ø¶ÙŠ (Ù…Ø´ Ø£ØµÙØ§Ø±)
                        if (idColumns.includes(C) && R > 0) {
                            if (cell.v != null && cell.v !== '') {
                                const raw = String(cell.v).trim();
                                if (raw !== '') {
                                    const cleanId = raw.replace(/\D/g, '').slice(0, 14); // Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·ØŒ Ø£Ù‚ØµÙ‰ 14
                                    if (cleanId !== '') {
                                        cell.v = cleanId;
                                        cell.t = 's'; // Ù†Øµ Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠØªØ­ÙˆÙ„Ø´ scientific
                                        cell.z = '0';
                                    } else {
                                        // Ù„Ùˆ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ù…ÙÙŠØ´ Ø£Ø±Ù‚Ø§Ù… â†’ Ø®Ù„ÙŠÙ‡ ÙØ§Ø¶ÙŠ
                                        cell.v = '';
                                        cell.t = 's';
                                    }
                                }
                            }
                        }

                        if (cell.t === 'n' && cell.v > 9007199254740991) {
                            cell.t = 's';
                            cell.v = cell.v.toString();
                        }

                        const len = String(cell.v || '').length + 4;
                        colWidths[C] = Math.max(colWidths[C] || 12, Math.min(len, 50));
                    }
                }

                ws['!cols'] = colWidths.map(w => ({ wch: w }));
                ws['!autofilter'] = { ref: ws['!ref'] };
            });

            const newWB = XLSX.utils.book_new();
            workbook.SheetNames.forEach(name => {
                XLSX.utils.book_append_sheet(newWB, workbook.Sheets[name], name);
            });
            const newData = XLSX.write(newWB, { bookType: 'xlsx', type: 'array', compression: true });
            processedFileBlob = new Blob([newData], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });

            renderPreview();

            setLoading(false);
            statusMessage.textContent = `ØªÙ… Ù…Ø¹Ø§Ù„Ø¬Ø© ${workbook.SheetNames.length} Ø´ÙŠØª Ø¨ÙØ®Ø§Ù…Ø©! Ø§Ù„Ø®Ø§Ù†Ø© ÙØ§Ø¶ÙŠØ© = ÙØ§Ø¶ÙŠØ© ğŸ‘‘`;
            actionsContainer.classList.remove('hidden');
            previewArea.classList.remove('hidden');

        } catch (err) {
            console.error(err);
            setLoading(false);
            statusMessage.textContent = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ù„Ù! ØªØ£ÙƒØ¯ Ù…Ù† ØµÙŠØºØ© Ø§Ù„Ø¥ÙƒØ³Ù„.';
            alert('Ø­Ø¯Ø« Ø®Ø·Ø£: ' + err.message);
        }
    }

    function renderPreview() {
        previewTabs.innerHTML = '';
        previewContainer.innerHTML = '<p class="text-center text-2xl text-amber-400">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©...</p>';

        workbook.SheetNames.forEach((name, idx) => {
            const tab = document.createElement('button');
            tab.className = `px-8 py-4 rounded-t-2xl font-bold text-lg transition ${idx === 0 ? 'tab-active text-amber-900' : 'glass hover:bg-amber-500/30'}`;
            tab.textContent = name;
            tab.onclick = () => {
                document.querySelectorAll('#preview-tabs button').forEach(t => t.classList.remove('tab-active', 'text-amber-900'));
                tab.classList.add('tab-active', 'text-amber-900');
                
                let html = '<table class="min-w-full table-auto border-collapse text-lg"><thead><tr>';
                const ws = workbook.Sheets[name];
                const range = XLSX.utils.decode_range(ws['!ref']);
                
                for (let C = range.s.c; C <= range.e.c; ++C) {
                    const cell = ws[XLSX.utils.encode_cell({ c: C, r: 0 })];
                    html += `<th class="gold-gradient font-extrabold">${cell ? cell.v : ''}</th>`;
                }
                html += '</tr></thead><tbody>';

                const maxRows = Math.min(range.e.r + 1, 200);
                for (let R = 1; R < maxRows; ++R) {
                    html += '<tr>';
                    for (let C = range.s.c; C <= range.e.c; ++C) {
                        const cell = ws[XLSX.utils.encode_cell({ c: C, r: R })];
                        let value = '';
                        let cellClass = '';
                        if (cell && cell.v != null) {
                            if (idColumns.includes(C)) {
                                if (cell.v === '') {
                                    value = '<span class="empty-id">ÙØ§Ø¶ÙŠØ©</span>';
                                } else {
                                    value = `<span class="gold-cell">${cell.v}</span>`;
                                }
                            } else {
                                value = cell.v;
                            }
                        }
                        html += `<td class="${cellClass}">${value}</td>`;
                    }
                    html += '</tr>';
                }
                if (range.e.r >= 200) {
                    html += `<tr><td colspan="${range.e.c + 1}" class="text-center text-amber-400 font-bold">... Ùˆ ${range.e.r - 199} ØµÙ Ø¢Ø®Ø±</td></tr>`;
                }
                html += '</tbody></table>';
                
                previewContainer.innerHTML = html;
                makeTableFakhma();
            };
            previewTabs.appendChild(tab);
        });

        if (workbook.SheetNames.length > 0) {
            previewTabs.firstChild?.click();
        } else {
            previewContainer.innerHTML = '<p class="text-center text-red-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª!</p>';
        }
    }

    function makeTableFakhma() {
        const table = previewContainer.querySelector('table');
        if (!table) return;
        table.querySelectorAll('th').forEach(th => th.classList.add('sticky-header'));
        table.querySelectorAll('td:first-child, th:first-child').forEach(c => c.classList.add('sticky-col'));
    }

    function downloadFile() {
        if (!processedFileBlob || !originalFileName) {
            alert('Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ø¬Ø§Ù‡Ø²!');
            return;
        }

        try {
            const url = URL.createObjectURL(processedFileBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Ù†Ø¸ÙŠÙ_ÙØ§Ø®Ø±_${originalFileName}.xlsx`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            statusMessage.textContent = 'ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨ÙØ®Ø§Ù…Ø©! Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ù„Ù Ø§Ù„ØªØ§Ù„ÙŠ ğŸ‘‘';
            fileUpload.value = '';
            processedFileBlob = null;
        } catch (e) {
            console.error(e);
            alert('ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„! Ø¬Ø±Ø¨ ÙƒØ±ÙˆÙ… Ø£Ùˆ ÙØ§ÙŠØ±ÙÙˆÙƒØ³');
        }
    }

    async function copyAsImage() {
        copyImage.disabled = true;
        copyImage.innerHTML = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø³Ø­Ø±ÙŠ...';
        try {
            const canvas = await html2canvas(previewContainer, { scale: 3, backgroundColor: '#1e293b', useCORS: true });
            canvas.toBlob(blob => {
                navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })]);
                alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨ÙØ®Ø§Ù…Ø©! Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¢Ù† âœ¨');
            });
        } catch (e) { 
            alert('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®ØŒ Ø¬Ø±Ø¨ Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© ÙŠØ¯ÙˆÙŠØ©'); 
        }
        copyImage.disabled = false;
        copyImage.innerHTML = '<span>ğŸ“‹ Ù†Ø³Ø® Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨</span>';
    }

    function shareOnWhatsapp() {
        if (!processedFileBlob) {
            alert('Ø§Ø±ÙØ¹ Ù…Ù„Ù Ø£ÙˆÙ„Ø§Ù‹!');
            return;
        }
        const url = URL.createObjectURL(processedFileBlob);
        const waUrl = `https://api.whatsapp.com/send?text=Ù…Ù„Ù Ù†Ø¸ÙŠÙ ÙØ§Ø®Ø± Ù…Ù† Ù‚ÙˆØ§ÙÙ„ Ù…Ø­Ù…Ø¯ Ø±Ø¬Ø¨ ğŸ‘‘%0A${originalFileName}.xlsx%0A${encodeURIComponent(url)}`;
        window.open(waUrl, '_blank');
    }
</script>
</body>
</html>
